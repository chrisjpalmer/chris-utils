#!/bin/sh

export WORKDIR=$PWD

INSTALL_DIR=$HOME/scripts

cd $INSTALL_DIR

arglist=""
for var in "$@"
do
    if [ "${var}" == "-i" ]; then
        INTERACTIVE=true
        OUTPUT="$(mktemp)"
        arglist="${arglist} -o ${OUTPUT}"
    else
        arglist="${arglist} ${var}"
    fi
done

$INSTALL_DIR/node_modules/.bin/tsx ./forcepush.ts $arglist

if [ -n "${INTERACTIVE}" ]; then
    # echo "Executing $(cat "${OUTPUT}")"
    # sleep 1
    cd "${WORKDIR}" && bash "${OUTPUT}"
fi

rm -f "${OUTPUT}"